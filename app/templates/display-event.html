{% extends "base.html" %}
{% block style%}
<link rel="stylesheet" href="/static/css/display-event.css">
{% endblock%}

{% block content %}
<style>
.container{
    padding:20px;
    margin-top:100px;
    max-width:500px;
    text-align:center;
    background-color: #fafafa;
    box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2);
    text-align:left;
    padding:10px;
}
.modal{
    position:fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background:white;
    padding: 20px;
    padding: 10px;
    width: auto;
}
.fade{
    opacity:1;
}

.nav .nav-tabs > .active {
     background:grey;
}

a.button-accept {
    background-color: #5cb85c;
    color: white;
    cursor: pointer;
    width: auto;
    border-radius: 5px;
    border: none;
    padding: 10px 15px;
}

a.button-accept:hover {
    transition: 0.8s;
    opacity: 0.8;
}

a.button-maybe {
    background-color: #f0ad4e;;
    color: white;
    cursor: pointer;
    width: auto;
    border-radius: 5px;
    border: none;
    padding: 10px 15px;
}

a.button-maybe:hover {
    transition: 0.8s;
    opacity: 0.8;
}

a.button-decline {
    background-color: #d9534f;
    color: white;
    cursor: pointer;
    width: auto;
    border-radius: 5px;
    border: none;
    padding: 10px 15px;
}

a.button-decline:hover {
    transition: 0.8s;
    opacity: 0.8;
}

.dp {
    width: 50px;
    height: 50px;
}
</style>
<body>
   <div class="container">
       <h1>{{event['name'] }}</h1>
       <hr>
       {% set datetime1 = (event.start|string).split(' ') %}
        <h6>Start Date: {{datetime1[0]}} Time: {{datetime1[1].split(':')[0]}}:{{datetime1[1].split(':')[1]}}</h6>
        {% set datetime2 = (event.end|string).split(' ') %}
        <h6>End Date: {{datetime2[0]}} Time: {{datetime2[1].split(':')[0]}}:{{datetime2[1].split(':')[1]}}</h6>
       <h2>Description</h2>
       <p>{{event['description']}}</p>
       <div class="inviteField">
           <h2>Invitation Status</h2>
           {% if status == "invited" %}
           <p>You have been invited by [host name/email].<br>
            <hr>
           <div style="text-align:center">
                <a class="button-accept" href="{{url_for('acceptInvite', eventId = event['_id'],acceptance = "going")}}"><i class="fa fa-calendar-check-o"></i> Accept</a>
                <a class="button-maybe" href="{{url_for('acceptInvite', eventId = event['_id'], acceptance = "maybe")}}"><i class="fa fa-calendar-minus-o"></i> Maybe</a></button>
                <a class="button-decline" href="{{url_for('acceptInvite', eventId = event['_id'], acceptance = "decline")}}"><i class="fa fa-calendar-times-o"></i> Decline</a></button>
            <hr>
            </div>
           {% else %}
            <p>{{status}}</p>
           <h2>Co-Hosts
            <button type="button" class="btn btn-primary btn-sm" data-toggle="modal" data-target="#addCohosts" style="float:right">View All</button></h2>
           {% endif %}
           <p><h2>Invited Guests <button type="button" class="btn btn-primary btn-sm" data-toggle="modal" data-target="#DisplayFriends" style="float:right">View All</button></h2>
        </div>
        <ul>
           {% for dictionary_item in event['invitees'] %}
                <p><a href="{{url_for('deleteInvite', eventId = event['_id'], userId = dictionary_item['id'])}}">
                    {% if (host ==1 or canInvite == 1) and loop.index != 1 %}
                        <i class="fa fa-times" aria-hidden="true"></i>
                    {% else %}
                    {% endif %}
                </a>  {{dictionary_item['email']}}</p>
           {% endfor %}
        </ul>
        <!-- Parts of this code was from https://getbootstrap.com/docs/4.0/components/navs/ -->
             <div class="modal fade" id = "DisplayFriends" role="dialog">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
                <ul class="nav nav-tabs">
                    <li class="active">
                       <a data-toggle = "tab" href="#going">Going</a>
                    </li>
                    <li >
                       <a data-toggle = "tab" href="#maybe">Maybe</a>
                    </li>
                    <li>
                       <a data-toggle = "tab" href="#declined">Not going</a>
                    </li>
                    <li>
                       <a data-toggle = "tab" href="#invited">Invited</a>
                    </li>
                </ul>
                <div class="tab-content">

                    <div id = "going" class="tab-pane fade in active"><p>
                        <ul>
                            {% if going %}
                                {% for item in going%}
                                    <p><img src="/static/images/profile/{{item['pictureDir']}}" class="dp">
                                    {{item['name']}}<br><br>
                                {% endfor%}
                            {% else %}
                                <h4 style="text-align:center">No responses yet</h4>
                            {% endif %}
                        </ul>
                    </div>
                    <div id = "maybe" class="tab-pane fade in"><p>
                        <ul>
                            {% if maybe %}
                                {% for item in maybe%}
                                    <p><img src="/static/images/profile/{{item['pictureDir']}}" class="dp">
                                    {{item['name']}}<br><br>
                                {% endfor%}
                            {% else %}
                                <h4 style="text-align:center">No responses yet</h4>
                            {% endif %}
                        </ul>
                    </div>
                    <div id = "declined" class="tab-pane fade in"><p>
                        <ul>
                            {% if declined %}
                                {% for item in declined%}
                                    <p><img src="/static/images/profile/{{item['pictureDir']}}" class="dp">
                                    {{item['name']}}<br><br>
                                {% endfor%}
                            {% else %}
                                <h4 style="text-align:center">No responses yet</h4>
                            {% endif %}
                        </ul>
                    </div>
                    <div id = "invited" class="tab-pane fade in"><p>
                        <ul>
                            {%if host == 1 %}
                                {% for item in invited%}
                                  <li> {{item['name']}}  </li> <img src="/static/images/profile/{{item['pictureDir']}}" class="dp">
                                {% endfor%}
                            {% else %}
                                {% if invited %}
                                    {% for item in invited %}
                                    <p><img src="/static/images/profile/{{item['pictureDir']}}" class="dp">
                                    {{item['name']}}
                                    {% endfor%}
                                {% else %}
                                <h4 style="text-align:center">No invitees yet</h4>
                                {% endif%}
                            {% endif %}
                        </ul>
                    </div>
                   </div>
              </div>

           <!-- End code from https://getbootstrap.com/docs/4.0/components/navs/ -->
    {% if host == 1 %}
        <input type = "text" id = "myInput" onkeyup ="hi('friends','myInput')" placeholder="Search for your friends">
        <ul id = "friends"></ul>
        {% else %}
    {% endif %}
   </div>


   <div class="modal fade" id = "addCohosts" role="dialog">
       <h3>Other Admins</h3>
       {% for item in cohosts %}
       <div class="cohost-list row">

            <img class="col-lg-1 col-sm-2 img-responsive" src = "/static/images/profile/{{item['pictureDir']}}"/>
            <p> {{item['name']}}</p> 
       </div>
       {% endfor %}
       <!-- all the cohosts are here -->
       {% if host == 1 or canInvite == 1%}
       <br>
       <input type = "text" id = "coHostInput" onkeyup ="hi('coHosts','coHostInput')" placeholder="Add more event admins">
       <ul id = "coHosts"></ul>
   </div>

   <script type="text/javascript" src="{{ url_for('static', filename='js/display-event.js') }}"></script>
   <script>
       function hi(whichModal,whichInput){

           var id = "{{event['_id']}}"
           var friendlist = {{friends | safe}};
           console.log(friendlist)
           myFunction(friendlist,id,whichModal,whichInput)
       }
   </script>
    {% else %}
    </div>
    {%endif%}

</body>

{% endblock %}
